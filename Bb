import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlProperty;
import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;

import java.util.List;

@JacksonXmlRootElement(localName = "Search")
public class XmlData {
    @JacksonXmlProperty(localName = "CustRepOptSubscr")
    private CustRepOptSubscr custRepOptSubscr;

    @JacksonXmlProperty(localName = "Acct")
    private Acct acct;

    @JacksonXmlProperty(localName = "Per")
    private Per per;

    @JacksonXmlProperty(localName = "SecLendCommissRep")
    private SecLendCommissRep secLendCommissRep;

    // Getters and setters
}

class CustRepOptSubscr {
    @JacksonXmlProperty(localName = "schdId")
    private String schdId;

    @JacksonXmlProperty(localName = "tmplId")
    private String tmplId;

    @JacksonXmlProperty(localName = "tmplDetlId")
    private String tmplDetlId;

    // Getters and setters
}

class Acct {
    @JacksonXmlProperty(localName = "ACCTNAME")
    private String acctName;

    @JacksonXmlProperty(localName = "AcctId")
    private AcctId acctId;

    // Getters and setters
}

class AcctId {
    @JacksonXmlProperty(localName = "acctOrig")
    private String acctOrig;

    @JacksonXmlProperty(localName = "acctId")
    private String acctId;

    // Getters and setters
}

class Per {
    @JacksonXmlProperty(localName = "PerStart")
    private PerStart perStart;

    @JacksonXmlProperty(localName = "PerEnd")
    private PerEnd perEnd;

    // Getters and setters
}

class PerStart {
    @JacksonXmlProperty(localName = "dt")
    private String dt;

    @JacksonXmlProperty(localName = "effctvTmstmp")
    private String effctvTmstmp;

    @JacksonXmlProperty(localName = "busEvnt")
    private String busEvnt;

    @JacksonXmlProperty(localName = "busTime")
    private String busTime;

    // Getters and setters
}

class PerEnd {
    @JacksonXmlProperty(localName = "dt")
    private String dt;

    @JacksonXmlProperty(localName = "effctvTmstmp")
    private String effctvTmstmp;

    @JacksonXmlProperty(localName = "busEvnt")
    private String busEvnt;

    @JacksonXmlProperty(localName = "busTime")
    private String busTime;

    // Getters and setters
}

class SecLendCommissRep {
    @JacksonXmlProperty(localName = "SecLendCommissDetl")
    private List<SecLendCommissDetl> secLendCommissDetls;

    // Getters and setters
}

class SecLendCommissDetl {
    @JacksonXmlProperty(localName = "loanTyp")
    private String loanTyp;

    @JacksonXmlProperty(localName = "lenBorrInd")
    private String lenBorrInd;

    @JacksonXmlProperty(localName = "streetChgd")
    private String streetChgd;

    @JacksonXmlProperty(localName = "LoanRef")
    private String loanRef;

    @JacksonXmlProperty(localName = "UTI")
    private String uti;

    @JacksonXmlProperty(localName = "ExtRef")
    private String extRef;

    @JacksonXmlProperty(localName = "LoanOpngDt")
    private String loanOpngDt;

    @JacksonXmlProperty(localName = "LoanClsgDt")
    private String loanClsgDt;

    @JacksonXmlProperty(localName = "LoanQty")
    private LoanQty loanQty;

    @JacksonXmlProperty(localName = "Loanval")
    private Loanval loanval;

    @JacksonXmlProperty(localName = "BondPrcAccrint")
    private String bondPrcAccrint;

    @JacksonXmlProperty(localName = "Cxchgate")
    private Cxchgate cxchgate;

    @JacksonXmlProperty(localName = "Feellate")
    private String feellate;

    @JacksonXmlProperty(localName = "DivCoupReq")
    private String divCoupReq;

    @JacksonXmlProperty(localName = "Hd1gFeeAmnt")
    private Hd1gFeeAmnt hd1gFeeAmnt;

    @JacksonXmlProperty(localName = "CurntCommissAmnt")
    private CurntCommissAmnt curntCom

class SecLendCommissDetl {
    // ...

    @JacksonXmlProperty(localName = "CurntCommissAmnt")
    private CurntCommissAmnt curntCommissAmnt;

    @JacksonXmlProperty(localName = "AccrCommissAmnt")
    private AccrCommissAmnt accrCommissAmnt;

    @JacksonXmlProperty(localName = "CollPldgIrktval")
    private CollPldgIrktval collPldgIrktval;

    @JacksonXmlProperty(localName = "CollPldgFeeRate")
    private String collPldgFeeRate;

    @JacksonXmlProperty(localName = "CollPldgCurntCommissAmnt")
    private CollPldgCurntCommissAmnt collPldgCurntCommissAmnt;

    @JacksonXmlProperty(localName = "CollPldgAccrCommissAmnt")
    private CollPldgAccrCommissAmnt collPldgAccrCommissAmnt;

    @JacksonXmlProperty(localName = "CurntCommissStartDt")
    private String curntCommissStartDt;

    @JacksonXmlProperty(localName = "CurntCommissEndDt")
    private String curntCommissEndDt;

    // Getters and setters
}

class LoanQty {
    @JacksonXmlProperty(localName = "qtyTyp")
    private String qtyTyp;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class Loanval {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class Cxchgate {
    @JacksonXmlProperty(localName = "frstIsoCurrCd")
    private String frstIsoCurrCd;

    @JacksonXmlProperty(localName = "recpIsoCurrCd")
    private String recpIsoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class Hd1gFeeAmnt {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class CurntCommissAmnt {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class AccrCommissAmnt {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class CollPldgIrktval {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class CollPldgCurntCommissAmnt {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}

class CollPldgAccrCommissAmnt {
    @JacksonXmlProperty(localName = "IsoCurrCd")
    private String isoCurrCd;

    @JacksonXmlProperty(localName = "value")
    private String value;

    // Getters and setters
}


// ...

private void convertXmlToCsv() throws Exception {
    // Read XML file
    File xmlFile = new File(XML_FILE_PATH);
    XmlMapper xmlMapper = new XmlMapper();
    XmlData data = xmlMapper.readValue(xmlFile, XmlData.class);

    // Write to CSV file
    try (FileWriter writer = new FileWriter(CSV_FILE_PATH);
         CSVWriter csvWriter = new CSVWriter(writer)) {
        csvWriter.writeNext(new String[] {"loanTyp", "lenBorrInd", "streetChgd", "LoanRef", "UTI", "ExtRef", "LoanOpngDt", "LoanClsgDt", "LoanQty", "Loanval", "BondPrcAccrint", "Cxchgate", "Feellate", "DivCoupReq", "Hd1gFeeAmnt", "CurntCommissAmnt", "AccrCommissAmnt", "CollPldgIrktval", "CollPldgFeeRate", "CollPldgCurntCommissAmnt", "CollPldgAccrCommissAmnt", "CurntCommissStartDt", "CurntCommissEndDt"});

        for (SecLendCommissDetl detl : data.getSecLendCommissRep().getSecLendCommissDetls()) {
            csvWriter.writeNext(new String[] {
                    detl.getLoanTyp(),
                    detl.getLenBorrInd(),
                    detl.getStreetChgd(),
                    detl.getLoanRef(),
                    detl.getUti(),
                    detl.getExtRef(),
                    detl.getLoanOpngDt(),
                    detl.getLoanClsgDt(),
                    detl.getLoanQty().getValue(),
                    detl.getLoanval().getValue(),
                    detl.getBondPrcAccrint(),
                    detl.getCxchgate().getValue(),
                    detl.getFeellate(),
                    detl.getDivCoupReq(),
                    detl.getHd1gFeeAmnt().getValue(),
                    detl.getCurntCommissAmnt().getValue(),
                    detl.getAccrCommissAmnt().getValue(),
                    detl.getCollPldgIrktval().getValue(),
                    detl.getCollPldgFeeRate(),
                    detl.getCollPldgCurntCommissAmnt().getValue(),
                    detl.getCollPldgAccrCommissAmnt().getValue(),
                    detl.getCurntCommissStartDt(),
                    detl.getCurntCommissEndDt()
            });
        }
    } catch (IOException e) {
        throw new RuntimeException(e);
    }
}
